    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
        h1 { border-bottom: 2px solid #ccc; padding-bottom: 10px; }
        #newTaskInput, #searchBar { padding: 10px; width: 70%; margin-right: 10px; border: 1px solid #ccc; border-radius: 4px;}
        #searchBar { width: 90%; margin-bottom: 15px; }
        #addTaskBtn { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        #taskList { list-style: none; padding: 0; }
        .task-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px; 
            border: 1px solid #eee; 
            background: #fff;
            margin-bottom: 8px;
            border-radius: 4px;
        }
        .task-text { flex-grow: 1; margin-right: 10px; font-size: 1.1em; }
        .completed { text-decoration: line-through; color: #888; background-color: #f0f0f0; }
        .actions button { padding: 6px 10px; margin-left: 5px; border-radius: 4px; border: none; cursor: pointer; }
        .mark-complete-btn { background-color: #ffc107; color: #333; }
        .remove-btn { background-color: #dc3545; color: white; }
    </style>
</head>
<body>
    <h1>Enhanced Todo List</h1>

    <input type="text" id="searchBar" placeholder="Search tasks in real time...">

    <form id="addForm">
        <input type="text" id="newTaskInput" placeholder="Enter new task..." required>
        <button type="submit" id="addTaskBtn">Add Task</button>
    </form>

    <h2>Tasks:</h2>
    <ul id="taskList">
        </ul>

    <script>
        // DOM Element References
        const addForm = document.getElementById('addForm');
        const newTaskInput = document.getElementById('newTaskInput');
        const taskList = document.getElementById('taskList');
        const searchBar = document.getElementById('searchBar');
        const STORAGE_KEY = 'enhancedTodoList';
        let tasks = []; 

        function loadTasks() {
            const storedTasks = localStorage.getItem(STORAGE_KEY);
            if (storedTasks) {
                try {
                    // Store tasks as a JSON array
                    tasks = JSON.parse(storedTasks);
                } catch (e) {
                    console.error("Error parsing tasks from localStorage:", e);
                    tasks = [];
                }
            }
            renderTasks(); 
        }

        function saveTasks() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
        }
        function renderTasks(searchQuery = '') {
            taskList.innerHTML = '';
            const query = searchQuery.toLowerCase().trim();
            const filteredTasks = tasks.filter(task => 
                task.text.toLowerCase().includes(query)
            );

            filteredTasks.forEach(task => {
                const li = document.createElement('li');
                li.className = `task-item ${task.completed ? 'completed' : ''}`;
                li.setAttribute('data-id', task.id);

                li.innerHTML = `
                    <span class="task-text">${task.text}</span>
                    <div class="actions">
                        <button class="mark-complete-btn" data-action="toggle">
                            ${task.completed ? 'Unmark' : 'Complete'}
                        </button>
                        <button class="remove-btn" data-action="remove">Remove</button>
                    </div>
                `;

                taskList.appendChild(li);
            });
        }
        addForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const text = newTaskInput.value.trim();

            if (text) {
                const newTask = {
                    id: Date.now(), 
                    text: text,     
                    completed: false 
                };

                tasks.push(newTask);
                saveTasks();
                renderTasks(searchBar.value); 
                newTaskInput.value = '';
            }
        });
        taskList.addEventListener('click', (e) => {
            const target = e.target;
            const listItem = target.closest('.task-item');
            if (!listItem) return;

            const taskId = parseInt(listItem.getAttribute('data-id'));
            const action = target.getAttribute('data-action');
            
            const taskIndex = tasks.findIndex(t => t.id === taskId);
            if (taskIndex === -1) return;

            if (action === 'toggle') {
                tasks[taskIndex].completed = !tasks[taskIndex].completed;
                saveTasks();
                renderTasks(searchBar.value); 

            } else if (action === 'remove') {
                tasks.splice(taskIndex, 1);
                saveTasks();
                renderTasks(searchBar.value);
            }
        });
        searchBar.addEventListener('input', (e) => {
            renderTasks(e.target.value);
        });
        document.addEventListener('DOMContentLoaded', loadTasks);
    </script>
</body>
</html>